== BLAS example program (Fortran)

A simple long-running BLAS job needing not a lot of memory.

- Performs multiple single-precision matrix multiplication (SGEMM): C = A Ã— B with column-major layout, no transposes, alpha=1, beta=0.
- Repeats the GEMM operation a configurable number of times and measures only the time spent inside the GEMM calls.
- CPU backend only (links to BLAS provider such as OpenBLAS/BLIS/MKL via -lblas).

Example JSON result:

[source,json]
----
{
  "engine": {"name":"BLAS"},
  "input": {"M":4096,"N":4096,"K":4096,"repeats":100,"expected_bytes_total":201326592,"expected_megabytes_total":192.0},
  "output": {"time_sec": 23.435000, "gflops": 586.46, "checksum": -2304.952393}
}
----

On failures (e.g., invalid arguments), the program would print a JSON object with an "error" field along with the input information (not all errors are intercepted).

=== Building with Nix

CPU (BLAS)::
[source,bash]
----
nix-build -E 'with import <nixpkgs> {}; callPackage ./default.nix { blas = blas; }' && \
./result/bin/blas-test-f90 4096 4096 100
----

=== Using Optimized Nix (with Zen optimizations)

To build the program with the optimized Nix setup from this repository:

CPU::
[source,bash]
----
nix-build -E 'with import ./../../../zen-optimized-pkgs.nix {}; callPackage ./default.nix { blas = blas; }' && \
./result/bin/blas-test-f90 4096 4096 100
----
